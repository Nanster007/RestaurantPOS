/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package possystem;

import java.io.IOException;
import java.text.DecimalFormat;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JButton;

/**
 *
 * @author tylar
 */
public class NewOrderPanel extends CustomPanel {

    private MainFrame mainFrame;
    private CustomerOrder customerOrder;

    public NewOrderPanel(MainFrame mainFrame, CustomerOrder customerOrder) {
        initComponents();
        setClockField(ClockLabel);
        this.customerOrder = customerOrder;
        this.mainFrame = mainFrame;
        OrderIDLabel.setText(customerOrder.getOrderID().toString());
        CustomerNameLabel.setText(customerOrder.getCustomerName());
        CustomerPhoneLabel.setText(customerOrder.getCustomerPhoneNumber());
        CustomerOrderTotalLabel.setText(String.format("%.2f", customerOrder.getOrderTotal()));

        if (customerOrder.getCustomerAddress() != null) {
            CustomerAddressLabel.setText(customerOrder.getCustomerAddress());
        } else {
            AddressLabel.setVisible(false);
            CustomerAddressLabel.setVisible(false);
        }

        OrderDetailsTextArea.setText(customerOrder.toString());

        setupMenuCategories();
    }

    private void setupMenuCategories() {
        for (String categoryName : this.mainFrame.getMenu().getMenuCategoryNames()) {
            JButton button = new JButton(categoryName);
            button.addActionListener(evt -> {
                MenuCategoryButtonActionPerformed(evt);
            });

            this.MenuCategoriesPanel.add(button);
        }
    }

    private void MenuCategoryButtonActionPerformed(java.awt.event.ActionEvent evt) {
        JButton button = (JButton) evt.getSource();
        String categoryName = button.getText();

        mainFrame.setNewPanel(new MenuCategoryPanel(mainFrame, customerOrder, categoryName), true, this);
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        TicketTextArea = new javax.swing.JScrollPane();
        OrderDetailsTextArea = new javax.swing.JTextArea();
        MenuCategoriesPanel = new javax.swing.JPanel();
        CurrentOrderLabel = new javax.swing.JLabel();
        NameLabel = new javax.swing.JLabel();
        PhoneNumberLabel = new javax.swing.JLabel();
        OrderTotalLabel = new javax.swing.JLabel();
        EditInfoButton = new javax.swing.JButton();
        UsernameLabel = new javax.swing.JLabel();
        ClockLabel = new javax.swing.JTextField();
        OrderIDLabel = new javax.swing.JLabel();
        CustomerNameLabel = new javax.swing.JLabel();
        CustomerPhoneLabel = new javax.swing.JLabel();
        AddressLabel = new javax.swing.JLabel();
        CustomerAddressLabel = new javax.swing.JLabel();
        CustomerOrderTotalLabel = new javax.swing.JLabel();
        CancelOrderButton = new javax.swing.JButton();
        PlaceOrderButton = new javax.swing.JButton();

        OrderDetailsTextArea.setColumns(20);
        OrderDetailsTextArea.setRows(5);
        OrderDetailsTextArea.setText("order items & prices");
        TicketTextArea.setViewportView(OrderDetailsTextArea);

        MenuCategoriesPanel.setLayout(new java.awt.GridLayout(5, 0));

        CurrentOrderLabel.setText("Current Order:");

        NameLabel.setText("Name:");

        PhoneNumberLabel.setText("Phone Number:");

        OrderTotalLabel.setText("Order Total:  $");

        EditInfoButton.setText("Change Customer Info");
        EditInfoButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                EditInfoButtonActionPerformed(evt);
            }
        });

        UsernameLabel.setText("User's Name");

        ClockLabel.setText("jTextField1");

        OrderIDLabel.setText("jLabel6");

        CustomerNameLabel.setText("jLabel7");

        CustomerPhoneLabel.setText("jLabel8");

        AddressLabel.setText("Address:");

        CustomerAddressLabel.setText("jLabel10");

        CustomerOrderTotalLabel.setText("jLabel11");

        CancelOrderButton.setText("Cancel Order");
        CancelOrderButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                CancelOrderButtonActionPerformed(evt);
            }
        });

        PlaceOrderButton.setText("Place Order");
        PlaceOrderButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                PlaceOrderButtonActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(layout.createSequentialGroup()
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                            .addComponent(ClockLabel)
                            .addComponent(UsernameLabel, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(CurrentOrderLabel)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(OrderIDLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 238, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(11, 11, 11)
                        .addComponent(CancelOrderButton))
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(MenuCategoriesPanel, javax.swing.GroupLayout.PREFERRED_SIZE, 343, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(TicketTextArea, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, 280, Short.MAX_VALUE)
                            .addGroup(layout.createSequentialGroup()
                                .addComponent(NameLabel)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(CustomerNameLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                            .addGroup(layout.createSequentialGroup()
                                .addComponent(PhoneNumberLabel)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(CustomerPhoneLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                            .addComponent(CustomerAddressLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addGroup(layout.createSequentialGroup()
                                .addComponent(OrderTotalLabel)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(CustomerOrderTotalLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                            .addGroup(layout.createSequentialGroup()
                                .addComponent(AddressLabel)
                                .addGap(0, 0, Short.MAX_VALUE))
                            .addComponent(PlaceOrderButton, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(EditInfoButton, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))))
                .addContainerGap())
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(UsernameLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 16, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(3, 3, 3)
                        .addComponent(ClockLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(layout.createSequentialGroup()
                        .addContainerGap()
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(CurrentOrderLabel)
                            .addComponent(OrderIDLabel)
                            .addComponent(CancelOrderButton))))
                .addGap(4, 4, 4)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(NameLabel)
                            .addComponent(CustomerNameLabel))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(PhoneNumberLabel)
                            .addComponent(CustomerPhoneLabel))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(AddressLabel)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(CustomerAddressLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(EditInfoButton, javax.swing.GroupLayout.PREFERRED_SIZE, 33, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(TicketTextArea, javax.swing.GroupLayout.PREFERRED_SIZE, 305, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(OrderTotalLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(CustomerOrderTotalLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(PlaceOrderButton))
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(MenuCategoriesPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addContainerGap())))
        );
    }// </editor-fold>//GEN-END:initComponents

    private void EditInfoButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_EditInfoButtonActionPerformed
        mainFrame.setNewPanel(new CustomerInfoPanel(mainFrame, customerOrder), true, this);
    }//GEN-LAST:event_EditInfoButtonActionPerformed

    private void CancelOrderButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_CancelOrderButtonActionPerformed
        mainFrame.setNewPanel(new MainMenuPanel(mainFrame), false, this);
        mainFrame.clearLastPanel();
    }//GEN-LAST:event_CancelOrderButtonActionPerformed

    private void PlaceOrderButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_PlaceOrderButtonActionPerformed
        mainFrame.setNewPanel(new MainMenuPanel(mainFrame), false, this);
        mainFrame.removeCustomerOrder(customerOrder.getOrderID().toString());
        try {
            mainFrame.addCustomerOrder(customerOrder);
        } catch (IOException ex) {
        }
    }//GEN-LAST:event_PlaceOrderButtonActionPerformed

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JLabel AddressLabel;
    private javax.swing.JButton CancelOrderButton;
    private javax.swing.JTextField ClockLabel;
    private javax.swing.JLabel CurrentOrderLabel;
    private javax.swing.JLabel CustomerAddressLabel;
    private javax.swing.JLabel CustomerNameLabel;
    private javax.swing.JLabel CustomerOrderTotalLabel;
    private javax.swing.JLabel CustomerPhoneLabel;
    private javax.swing.JButton EditInfoButton;
    private javax.swing.JPanel MenuCategoriesPanel;
    private javax.swing.JLabel NameLabel;
    private javax.swing.JTextArea OrderDetailsTextArea;
    private javax.swing.JLabel OrderIDLabel;
    private javax.swing.JLabel OrderTotalLabel;
    private javax.swing.JLabel PhoneNumberLabel;
    private javax.swing.JButton PlaceOrderButton;
    private javax.swing.JScrollPane TicketTextArea;
    private javax.swing.JLabel UsernameLabel;
    // End of variables declaration//GEN-END:variables
}
